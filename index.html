<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>לוח שנה עברי</title>
  <style>
    body {
      font-family: sans-serif;
      font-size: 22px;
      text-align: center;
      background-color: #f0f0f0;
    }
    .container {
      margin-top: 50px;
    }
    .title {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .value {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">השעה כעת:</div>
    <div class="value" id="time"></div>

    <div class="title">תאריך לועזי:</div>
    <div class="value" id="gregorian-date"></div>

    <div class="title">תאריך עברי:</div>
    <div class="value" id="hebrew-date"></div>

    <div class="title">פרשת השבוע:</div>
    <div class="value" id="parasha"></div>

    <div class="title">הדלקת נרות:</div>
    <div class="value" id="candle-lighting"></div>
  </div>

  <!-- Include the local Hebcal library -->
  <script src="hebcal.bundle.min.js"></script>
  <script>
    function pad(n) {
      return n < 10 ? '0' + n : n;
    }

    function updateTime() {
      const now = new Date();
      const timeStr = pad(now.getHours()) + ':' + pad(now.getMinutes());
      document.getElementById('time').textContent = timeStr;

      const weekdayNames = ['ראשון','שני','שלישי','רביעי','חמישי','שישי','שבת'];
      const monthNames = ['ינואר','פברואר','מרץ','אפריל','מאי','יוני','יולי','אוגוסט','ספטמבר','אוקטובר','נובמבר','דצמבר'];

      const gregStr = `${weekdayNames[now.getDay()]}, ${now.getDate()} ${monthNames[now.getMonth()]} ${now.getFullYear()}`;
      document.getElementById('gregorian-date').textContent = gregStr;
    }

    function updateJewishData() {
      try {
        const now = new Date();
        const hdate = new Hebcal.HDate(now);
        const hdStr = hdate.renderHebrewDate();
        document.getElementById('hebrew-date').textContent = hdStr;

        const events = Hebcal.HebrewCalendar.getHolidaysOnDate(hdate);
        const parasha = events.find(e => e.getDesc().startsWith('פרשת'));
        document.getElementById('parasha').textContent = parasha ? parasha.getDesc() : '—';

        const zmanim = new Hebcal.Zmanim({ date: now, latitude: 32.0853, longitude: 34.7818 });
        const candle = zmanim.candle_lighting();
        const candleStr = `${pad(candle.getHours())}:${pad(candle.getMinutes())}`;
        document.getElementById('candle-lighting').textContent = candleStr;
      } catch (err) {
        console.error('שגיאה בחישוב התאריך העברי או הפרשה:', err);
        document.getElementById('hebrew-date').textContent = '[שגיאה]';
        document.getElementById('parasha').textContent = '[שגיאה]';
        document.getElementById('candle-lighting').textContent = '[שגיאה]';
      }
    }

    window.onload = function() {
      updateTime();
      updateJewishData();
    };
  </script>
</body>
</html>
